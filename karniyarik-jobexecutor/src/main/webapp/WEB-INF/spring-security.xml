<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
        xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.4.xsd">

		 <!--http auto-config="true">
                <intercept-url pattern="/login.jsp" filters="none" />
				<intercept-url pattern="/css/**" filters="none" />
				<intercept-url pattern="/images/**" filters="none" />
				<intercept-url pattern="/js/**" filters="none" />
				<intercept-url pattern="/yaml/**" filters="none" />
                <intercept-url pattern="/**" access="ROLE_USER" />
                <form-login login-page="/login.jsp" default-target-url="/home.htm"
                        always-use-default-target="false" authentication-failure-url="/login.jsp?authfailed=true" />
                <logout invalidate-session="true" logout-url="/logout.htm"
                        logout-success-url="/login.jsp?loggedout=true" />

                <concurrent-session-control max-sessions="1"
                        exception-if-maximum-exceeded="true" />
        </http-->

 		<beans:bean id="sessionRegistry"
                class="org.springframework.security.concurrent.SessionRegistryImpl" />

        <beans:bean id="defaultConcurrentSessionController"
                class="org.springframework.security.concurrent.ConcurrentSessionControllerImpl">
                <beans:property name="sessionRegistry" ref="sessionRegistry" />
                <beans:property name="exceptionIfMaximumExceeded"
                        value="false" />
        </beans:bean>

        <beans:bean id="daoAuthenticationProvider"
                class="org.springframework.security.providers.dao.DaoAuthenticationProvider">
                <beans:property name="userDetailsService" ref="userDetailsService" />
                <beans:property name="hideUserNotFoundExceptions"
                        value="false" />
        </beans:bean>

        <beans:bean id="authenticationManager"
                class="org.springframework.security.providers.ProviderManager">
                <beans:property name="providers">
                        <beans:list>
                                <beans:ref local="daoAuthenticationProvider" />
                        </beans:list>
                </beans:property>
                <beans:property name="sessionController"
                        ref="defaultConcurrentSessionController" />
        </beans:bean>

        <beans:bean id="customAuthenticationProcessingFilter"
                class="org.springframework.security.ui.webapp.AuthenticationProcessingFilter">
                <custom-filter position="AUTHENTICATION_PROCESSING_FILTER" />
                <beans:property name="defaultTargetUrl" value="/jobs.jsp" />
                <beans:property name="authenticationManager" ref="authenticationManager" />
                <beans:property name="authenticationFailureUrl" value="/login.jsp?authfailed=true" />
                <beans:property name="allowSessionCreation" value="true" />
        </beans:bean>

        <beans:bean id="myAuthenticationEntryPoint"
                class="org.springframework.security.ui.webapp.AuthenticationProcessingFilterEntryPoint">
                <beans:property name="loginFormUrl" value="/login.jsp" />
        </beans:bean>

        <http entry-point-ref="myAuthenticationEntryPoint" auto-config="false">
                <intercept-url pattern="/login.jsp" filters="none" />
				<intercept-url pattern="/css/**" filters="none" />
				<intercept-url pattern="/rest/**" filters="none" />
				<intercept-url pattern="/images/**" filters="none" />
				<intercept-url pattern="/js/**" filters="none" />
				<intercept-url pattern="/yaml/**" filters="none" />
                <intercept-url pattern="/**" access="ROLE_USER" />
                <logout invalidate-session="true" logout-url="/logout.htm"
                        logout-success-url="/login.jsp?loggedout=true" />
        </http>

        <authentication-provider>
                <user-service id="userDetailsService">
						<user name="karniyarik" password="" authorities="ROLE_USER" />
                </user-service>
        </authentication-provider>
</beans:beans>